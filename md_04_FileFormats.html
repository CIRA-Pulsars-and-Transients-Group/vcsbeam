<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VCSBeam: File Formats</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VCSBeam
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">File Formats </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md14">RTS DI_JonesMatrix file format</a></li>
<li class="level1"><a href="#autotoc_md15">RTS BandpassCalibration file format</a></li>
<li class="level1"><a href="#offringa">Offringa/Hyperdrive calibration file format</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md14"></a>
RTS DI_JonesMatrix file format</h1>
<div class="fragment"><div class="line">Franz Kirsten &lt;franz.kirsten@curtin.edu.au&gt; 17 June 2016 at 17:42</div>
<div class="line">To: Sammy McSweeney &lt;sammy.mcsweeney@gmail.com&gt;, Steven Tremblay &lt;Steven.Tremblay@curtin.edu.au&gt;, Dr Stephen ORD &lt;steve.ord@gmail.com&gt;</div>
<div class="line">Hi Sam,</div>
<div class="line"> </div>
<div class="line">Mitch finally got back to me on my questions about the individual entries in the DI_Jones matrices as output by the RTS. If you have a chance, could you go through those and try to get Andre&#39;s solutions to work once more? Are Mitch&#39;s answers enough or do you need more details?</div>
<div class="line"> </div>
<div class="line">It would be great if you could tell people next week that the beamformer also works with those tools now -- no pressure ;)</div>
<div class="line"> </div>
<div class="line">Cheers,</div>
<div class="line">Franz</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">Hi Franz,</div>
<div class="line"> </div>
<div class="line">Sorry for the delay. Once you have this working I will let you know how to include the bandpass data.</div>
<div class="line"> </div>
<div class="line">Mitch</div>
<div class="line"> </div>
<div class="line">In an effort to automate calibrating the MWA for the tied-array beam, we</div>
<div class="line">are currently trying to compare the the DI-Jones matrices from the RTS</div>
<div class="line">with those produced by Andre Offringa&#39;s &#39;calibrate&#39;. We know exactly</div>
<div class="line">what is in Andre&#39;s solutions but are unsure about the</div>
<div class="line">structur/formatting of the RTS solutions. Could you give a detailed</div>
<div class="line">breakdown, please? In particular we were wondering about the following:</div>
<div class="line"> </div>
<div class="line">1) What is the number in the very first line?</div>
<div class="line"> </div>
<div class="line">This is the flux density of the calibrator that was used. You can ignore it.</div>
<div class="line"> </div>
<div class="line">The second line contains the model primary beam Jones matrix (in the direction of the calibrator).</div>
<div class="line"> </div>
<div class="line">2) Which column contains real/imaginary xx/yy/xy/yx?</div>
<div class="line"> </div>
<div class="line">XX_re XX_im XY_re XY_im YX_re YX_im YY_re YY_im</div>
<div class="line"> </div>
<div class="line">3) Are the numbers normalised in some way?</div>
<div class="line"> </div>
<div class="line">By the model primary beam Jones matrix (from the second line). If that is called B, and the direction-independent gain for tile i is G_i, then the numbers printed are G_i.B (call this J_i). So to get the direction-independent gain to compare with Andre&#39;s: G_i = J_i.inv(B).</div>
<div class="line"> </div>
<div class="line">4) Is there some conjugation going on?</div>
<div class="line"> </div>
<div class="line">No.</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md15"></a>
RTS BandpassCalibration file format</h1>
<div class="fragment"><div class="line">Sammy McSweeney &lt;sammy.mcsweeney@gmail.com&gt; 21 March 2017 at 12:09</div>
<div class="line">To: Daniel.Mitchell@csiro.au, Franz Kirsten &lt;franz.kirsten@curtin.edu.au&gt;, Steven Tremblay &lt;Steven.Tremblay@curtin.edu.au&gt;</div>
<div class="line">Hi Mitch,</div>
<div class="line"> </div>
<div class="line">Thanks for your explanation (via Franz, last year) of how the DIJones RTS output files are organised. If I could trouble you now for a similar explanation for how the Bandpass files are organised...</div>
<div class="line">As far as I can make out, the format is something like:</div>
<div class="line"> </div>
<div class="line">freq00 freq01 freq02 ... (minus any flagged channels)</div>
<div class="line">tilenum amp,phase, amp,phase, amp,phase, ...</div>
<div class="line">tilenum amp,phase, amp,phase, amp,phase, ...</div>
<div class="line">etc ...</div>
<div class="line"> </div>
<div class="line">I see that there are 8 rows per tile, but I&#39;m not how those 8 break down (into polarisation combinations, for example). Incidentally, what do the &quot;P&quot; and &quot;Q&quot; mean in &quot;PX&quot;, etc? (I see it cropping up in some of Steve Ord&#39;s plotting scripts.)</div>
<div class="line"> </div>
<div class="line">And, calling in your promised favour, anything you can tell me about &quot;how to include the bandpass data&quot; would be much appreciated.</div>
<div class="line"> </div>
<div class="line">Cheers,</div>
<div class="line">~/Sam</div>
</div><!-- fragment --><div class="fragment"><div class="line">Daniel.Mitchell@csiro.au &lt;Daniel.Mitchell@csiro.au&gt; 23 March 2017 at 06:55</div>
<div class="line">To: sammy.mcsweeney@gmail.com</div>
<div class="line">Cc: franz.kirsten@curtin.edu.au, Steven.Tremblay@curtin.edu.au</div>
<div class="line">Hi Sammy,</div>
<div class="line"> </div>
<div class="line">There are 8 lines for each antenna: Jm[0],Jf[0],Jm[1],Jf[1],Jm[2],Jf[2],Jm[3],Jf[3], where Jm contains the measured Jones matrices (measured separately for each frequency channel), and Jf contains low-order fits to these data, which are used in the RTS as the bandpass solutions (polynomials are fitted separately to the real and imaginary components of each Jones matrix element).</div>
<div class="line"> </div>
<div class="line">P and Q are the labels that we use for the two instrument polarisations (North-South and East-West respectively). X and Y are the standard sky polarisation coordinates, with X aligned with declination and Y aligned with RA.</div>
<div class="line"> </div>
<div class="line">The overall Jones matrix for a given channel of a given antenna will be the full-band matrix from the DIJones file multiplied by the bandpass matrix on the righthand side.</div>
<div class="line"> </div>
<div class="line">Cheers,</div>
<div class="line">Mitch</div>
</div><!-- fragment --><h1><a class="anchor" id="offringa"></a>
Offringa/Hyperdrive calibration file format</h1>
<div class="fragment"><div class="line">Offringa&#39;s own documentation for the format of these binary files (copied from an email</div>
<div class="line">dated 4 May 2016 from franz.kirsten@curtin.edu.au to sammy.mcsweeney@gmail.com). This is</div>
<div class="line">itself copied from Andre Offringa&#39;s original C++ code, in his Anoko repository, in</div>
<div class="line">mwa-reduce/solutionfile.h:</div>
<div class="line"> </div>
<div class="line">The solution file is used for storing calibration Jones matrices.</div>
<div class="line">The format is as follows:</div>
<div class="line">  Bytes |  Description</div>
<div class="line"> -------+---------------</div>
<div class="line">  0- 7  |  string intro ; 8-byte null terminated string &quot;MWAOCAL&quot;</div>
<div class="line">  8-11  |  int fileType ; always 0, reserved for indicating something other than complex Jones solutions</div>
<div class="line"> 12-15  |  int structureType ; always 0, reserved for indicating different ordering</div>
<div class="line"> 16-19  |  int intervalCount ; Number of solution intervals in file</div>
<div class="line"> 20-23  |  int antennaCount ; Number of antennas that were in the measurement set (but were not necessary all solved for)</div>
<div class="line"> 24-27  |  int channelCount ; Number of channels in the measurement set</div>
<div class="line"> 28-31  |  int polarizationCount ; Number of polarizations solved for -- always four.</div>
<div class="line"> 32-39  |  double startTime ; Start time of solutions (AIPS time)</div>
<div class="line"> 40-47  |  double endTime ; End time of solutions (AIPS time)</div>
<div class="line"> -------+-------------------</div>
<div class="line">After the header follow 2 x nSolution doubles, with</div>
<div class="line"> </div>
<div class="line">nSolutions = nIntervals * nAntennas * nChannels * nPols</div>
<div class="line"> </div>
<div class="line">Ordered in the way as given, so:</div>
<div class="line">double 0 : real of interval 0, antenna 0, channel 0, pol 0</div>
<div class="line">double 1 : imaginary of interval 0, antenna 0, channel 0, pol 0</div>
<div class="line">double 2 : real of interval 0, antenna 0, channel 0, pol 1</div>
<div class="line">...</div>
<div class="line">double 8 : real of interval 0, antenna 0, channel 1, pol 0</div>
<div class="line">double nChannel x 8 : real of interval 0, antenna 1, channel 0, pol 0</div>
<div class="line">etc.</div>
<div class="line"> </div>
<div class="line">ints are here always 32 bits unsigned integers, doubles are IEEE</div>
<div class="line">double precision 64 bit floating points.</div>
<div class="line">If a solution is not available, either because its data no data were</div>
<div class="line">selected during calibration for this interval</div>
<div class="line">or because the calibration diverged, a &quot;NaN&quot; will be stored in the</div>
<div class="line">doubles belonging to that solution.</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VCSBeam: Calibration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_tiny.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VCSBeam
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Calibration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md10">Obtaining the instrumental gains</a><ul><li class="level2"><a href="#rts">Real Time System (RTS)</a></li>
<li class="level2"><a href="#hyperdrive">Hyperdrive</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md11">Obtaining the primary beam model</a><ul><li class="level2"><a href="#hyperbeam">Hyperbeam</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_Calibration"></a></p>
<p>Calibration is the process by which the temporal variations in the instrumental and/or ionospheric response to an incoming signal are characterised, in order to account for them when processing observational data. A <em>calibration solution</em> is a mathematical operation that can be applied either to measured visibilities or raw voltages to correct for these variations, and recover the visibilities (or raw voltages) that would have been measured under ideal conditions.</p>
<p>For the MWA, calibration solutions are modelled as a tile-dependent, linear transformation of two orthogonal polarisations. Thus, the full calibration solution for each tile is represented by a \(2\times2\) Jones matrix, \({\bf J}\), which is multiplied to the incident electric field, \({\bf e}\), to predict the measured voltages, \({\bf v}\). </p><p class="formulaDsp">
\[ {\bf v} = {\bf J}{\bf e}. \]
</p>
<p> The form of \({\bf J}\) depends on the <a class="el" href="definitions.html#coordinatesystems">coordinate bases</a> used for \({\bf v}\) and \({\bf e}\). For example, </p><p class="formulaDsp">
\[ \begin{bmatrix} v_q \\ v_p \end{bmatrix} = \begin{bmatrix} J_{qx} &amp; J_{qy} \\ J_{px} &amp; J_{py} \end{bmatrix} \begin{bmatrix} e_x \\ e_y \end{bmatrix}, \]
</p>
<p> In practise, of course, the inverse operations are used to reconstruct the electric field from the measured voltages: </p><p class="formulaDsp">
\[ {\bf e} = {\bf J}^{-1}{\bf v}. \]
</p>
<p>Following <a href="https://www.cambridge.org/core/journals/publications-of-the-astronomical-society-of-australia/article/calibration-and-stokes-imaging-with-full-embedded-element-primary-beam-model-for-the-murchison-widefield-array/FBA84B9EB94000BD6258A8F75840C476#">Sokolowski et al., 2017</a>, \({\bf J}\) is calculated as the matrix product of two different matrices, </p><p class="formulaDsp">
\[ {\bf J} = {\bf D}{\bf B}, \]
</p>
<p> where</p><ul>
<li>\({\bf D}\) represents the (direction independent) instrumental gains, and</li>
<li>\({\bf B}\) represents the (direction dependent) tile beam response. \({\bf D}\) is obtained either from the Real Time System, or Hyperdrive. \({\bf B}\) is obtained from Hyperbeam.</li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
Obtaining the instrumental gains</h1>
<h2><a class="anchor" id="rts"></a>
Real Time System (RTS)</h2>
<p>The RTS is one of the pieces of software that can be used to generate calibration solutions for a VCS observation. The solutions are given in two sets of files, called "DI_JonesMatrices_nodeCCC.dat" (hereafter, DIJones) and `&lsquo;BandpassCalibration_nodeCCC.dat&rsquo;' (hereafter, Bandpass), where CCC represents a coarse channel index. The DIJones files contain both the Jones matrices for each tile for the given coarse channel, \({\bf J}_d\), as well as the beam response matrix that was used by the RTS during calibration, \({\bf B}_\text{cal}\). To get the calibration solutions for the fine channels, one must multiply \({\bf J}_d\) on the right by the matrices in the Bandpass files, \({\bf J}_b\).</p>
<p>The bases of these matrices are as follows: </p><p class="formulaDsp">
\begin{align*} {\bf J}_d &amp;= \begin{bmatrix} J_{px} &amp; J_{py} \\ J_{qx} &amp; J_{qy} \end{bmatrix}, &amp; {\bf J}_b &amp;= \begin{bmatrix} J_{px} &amp; J_{py} \\ J_{qx} &amp; J_{qy} \end{bmatrix}, &amp; {\bf B}_\text{cal} &amp;= \begin{bmatrix} B_{px} &amp; B_{py} \\ B_{qx} &amp; B_{qy} \end{bmatrix}. \end{align*}
</p>
<p> If you want to apply these calibration solutions to the same observation (an in particular, to the same calibrator source), then you can set </p><p class="formulaDsp">
\[ {\bf J} = {\bf J}_d \]
</p>
<p> for coarse channel approximations, or, for the fine channel solutions, </p><p class="formulaDsp">
\[ {\bf J} = {\bf J}_d {\bf J}_b \]
</p>
<p> If the calibration solution is to be applied to a different observation (in a different part of the sky), or even to a separate different direction in the same observation, then the instrumental gains must be reconstructed by factoring out the beam response: </p><p class="formulaDsp">
\[ {\bf D} = {\bf J}{\bf B}_\text{cal}^{-1}. \]
</p>
<p> The resulting instrumental gains matrix is in the basis </p><p class="formulaDsp">
\[ {\bf D} = \begin{bmatrix} D_{pp} &amp; D_{pq} \\ D_{qp} &amp; D_{qq} \end{bmatrix}. \]
</p>
<h2><a class="anchor" id="hyperdrive"></a>
Hyperdrive</h2>
<p>Hyperdrive is the faster, better successor to the RTS. Hyperdrive can output the instrumental gains matrices (per tile per fine channel) in the "Offringa" format, described in <a href="#offringa">Offringa format</a>. The matrices are in the basis: </p><p class="formulaDsp">
\[ {\bf D} = \begin{bmatrix} D_{qq} &amp; D_{qp} \\ D_{pq} &amp; D_{pp} \end{bmatrix}. \]
</p>
<h1><a class="anchor" id="autotoc_md11"></a>
Obtaining the primary beam model</h1>
<h2><a class="anchor" id="hyperbeam"></a>
Hyperbeam</h2>
<p>The primary beam is obtained using <a href="https://github.com/MWATelescope/mwa_hyperbeam">Hyperbeam</a>, which is based on the FEE beam model described in <a href="https://www.cambridge.org/core/journals/publications-of-the-astronomical-society-of-australia/article/calibration-and-stokes-imaging-with-full-embedded-element-primary-beam-model-for-the-murchison-widefield-array/FBA84B9EB94000BD6258A8F75840C476#">Sokolowski et al., 2017</a>. This gives the \({\bf B}\) matrix in the basis </p><p class="formulaDsp">
\[ {\bf B}_\text{hb} = \begin{bmatrix} B_{q\theta} &amp; B_{q\phi} \\ B_{p\theta} &amp; B_{p\phi} \end{bmatrix}. \]
</p>
<p> To obtain the beam matrix that converts from the \((x,y)\) basis to the \((q,p)\) basis, one must multiply \({\bf B}_\text{hb}\) on the right by the parallactic angle correction matrix: </p><p class="formulaDsp">
\[ {\bf B} = {\bf B}_\text{hb}{\bf P}_\text{pa} = \begin{bmatrix} B_{q\theta} &amp; B_{q\phi} \\ B_{p\theta} &amp; B_{p\phi} \end{bmatrix} \begin{bmatrix} P_{\theta x} &amp; P_{\theta y} \\ P_{\phi x} &amp; P_{\phi y} \end{bmatrix} = \begin{bmatrix} B_{qx} &amp; B_{qy} \\ B_{px} &amp; B_{py} \end{bmatrix} \]
</p>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
